"use strict";(self.webpackChunkjagruti_software=self.webpackChunkjagruti_software||[]).push([[9641],{10836:(e,s,n)=>{n.d(s,{Ay:()=>W,uA:()=>R});var i=n(80045),t=n(89379),l=n(65043),a=(n(27965),n(7245),n(72234)),r=n(2364),d=n(80899),o=n(86897),c=n(7493),m=n(12327),u=n(22345),h=n(72679),x=n(26259),v=n(6221),g=n(97550),f=n(77026),p=n(58509),A=n(9790),b=n(22166),j=n(92073),y=n(98093),w=n(10812),S=n(26802),N=n(14028),k=n(5780),T=n(46087),C=n(45627),D=n(60129),P=n(3929),z=n(51010),H=n(45479),I=n(91036),M=n(70579);const F=[10,15,30,40,50,60,75,90,120],E=(0,b.Ng)(e=>({userCenters:e.User.userCenters,centers:e.Center.data}))(e=>{var s,n;let{pricing:i,setPricing:a,sessionPricing:r,userCenters:d,doctor:o,toggle:g}=e;const f=(0,b.wA)(),p=function(e,s,n){let t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return!!e&&(e=Number(e),"online"===n?null===i||void 0===i||null===(a=i.online)||void 0===a?void 0:a.some((n,i)=>Number(n.session)===e&&i!==s&&""!==n.session):"offline"===n&&(null===i||void 0===i||null===(r=i.offline[t])||void 0===r||null===(d=r.pricings)||void 0===d?void 0:d.some((s,n)=>Number(s.session)===e&&n!==l&&""!==s.session)));var a,r,d},A=(e,s)=>{var n;return!!e&&(null===i||void 0===i||null===(n=i.offline)||void 0===n?void 0:n.some((n,i)=>n.center===e&&i!==s&&""!==n.center))},j=function(e,s,n,i){let l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if("price"===n)if(""===i)i="";else{const e=(e=>{const s=Number(e);return s<0?(I.oR.error("Price cannot be negative!"),!1):s%1===0||(I.oR.error("Price must be a whole number!"),!1)})(i);if(!e)return;i=Number(i)}if("session"===n){const e=(e=>{const s=Number(e);return e&&""!==e?isNaN(s)?(I.oR.error("Session duration must be a valid number!"),!1):s<0?(I.oR.error("Session duration cannot be negative!"),!1):s%1===0||(I.oR.error("Session duration must be a whole number!"),!1):(I.oR.error("Session duration is required!"),!1)})(i);if(!e)return;i=Number(i)}if("online"===e){if("session"===n&&p(i,s,"online"))return void I.oR.error("".concat(i," minutes session already exists in online pricing!"))}else if("offline"===e){if("center"===n){if(!((r=i)&&""!==r||(I.oR.error("Please select a center!"),0)))return;if(A(i,s))return void I.oR.error("This center already has pricing configured!")}if("session"===n&&p(i,s,"offline",s,l))return void I.oR.error("".concat(i," minutes session already exists for this center!"))}var r;a(a=>{const r=(0,t.A)({},a);return"online"===e?r.online=r.online.map((e,l)=>l===s?(0,t.A)((0,t.A)({},e),{},{[n]:i}):e):"offline"===e&&(r.offline=r.offline.map((e,a)=>{if(a===s){if("center"===n)return(0,t.A)((0,t.A)({},e),{},{[n]:i});const s=e.pricings.map((e,s)=>s===l?(0,t.A)((0,t.A)({},e),{},{[n]:i}):e);return(0,t.A)((0,t.A)({},e),{},{pricings:s})}return e})),r})};return(0,M.jsx)(l.Fragment,{children:(0,M.jsxs)(v.A,{onSubmit:e=>{e.preventDefault(),f(r?(0,y.tGx)({userId:null===o||void 0===o?void 0:o._id,sessionPricing:i}):(0,y.VwF)({sessionPricing:i,userId:null===o||void 0===o?void 0:o._id}))},className:"w-100 my-4",children:[(0,M.jsxs)(m.A,{className:"gap-4",children:[(0,M.jsxs)(u.A,{xs:12,md:6,className:"rounded-xl py-4 px-3 shadow-lg",children:[(0,M.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[(0,M.jsx)("h5",{className:"display-h5",children:"Online Pricing"}),(0,M.jsx)(x.A,{color:"primary",size:"sm",onClick:()=>{const e=(0,t.A)({},i);e.online=[...e.online||[],{session:"",price:""}],a(e)},children:"Add Session"})]}),null===i||void 0===i||null===(s=i.online)||void 0===s?void 0:s.map((e,s)=>(0,M.jsxs)(m.A,{className:"mb-3",children:[(0,M.jsx)(u.A,{xs:2,md:5,className:"d-flex align-items-end",children:(0,M.jsxs)("div",{className:"mt-auto",children:[(0,M.jsx)(c.A,{size:"sm",children:"Session"}),(0,M.jsxs)(h.A,{bsSize:"sm",type:"select",required:!0,value:e.session,onChange:e=>j("online",s,"session",e.target.value),children:[(0,M.jsx)("option",{value:"",selected:!0,disabled:!0,hidden:!0,children:"Choose here"}),F.map(e=>(0,M.jsxs)("option",{value:e,disabled:p(e,s,"online"),children:[e," min"]},e))]})]})}),(0,M.jsx)(u.A,{xs:2,md:5,children:(0,M.jsxs)("div",{className:"mt-auto",children:[(0,M.jsx)(c.A,{size:"sm",children:"Session Price"}),(0,M.jsx)(h.A,{bsSize:"sm",type:"text",required:!0,value:e.price,onChange:e=>j("online",s,"price",e.target.value),onKeyPress:e=>{/[0-9]/.test(e.key)||"Backspace"===e.key||e.preventDefault()}})]})}),(0,M.jsx)(u.A,{xs:2,md:2,className:"d-flex align-items-end",children:(0,M.jsx)(x.A,{size:"sm",onClick:()=>{return e=s,void a(s=>(0,t.A)((0,t.A)({},s),{},{online:s.online.filter((s,n)=>n!==e)}));var e},color:"danger",outline:!0,type:"button",className:"mb-1",children:(0,M.jsx)("i",{className:"ri-close-circle-line font-size-20"})})})]},s))]}),(0,M.jsxs)(u.A,{xs:12,md:12,className:"shadow-lg py-4 px-3",children:[(0,M.jsx)("h5",{className:"display-h5",children:"Offline Pricing"}),null===i||void 0===i||null===(n=i.offline)||void 0===n?void 0:n.map((e,s)=>(0,M.jsxs)(m.A,{className:"".concat(s!==i.offline.length-1?"border-bottom border-dark pb-4":""),children:[(0,M.jsx)(u.A,{xs:3,md:4,children:(0,M.jsxs)("div",{className:"",children:[(0,M.jsx)(c.A,{size:"sm",children:"Centers"}),(0,M.jsxs)(h.A,{bsSize:"sm",type:"select",required:!0,value:e.center,onChange:e=>j("offline",s,"center",e.target.value),children:[(0,M.jsx)("option",{value:"",selected:!0,disabled:!0,hidden:!0,children:"Choose here"}),(d||[]).map(e=>(0,M.jsx)("option",{value:e._id,disabled:A(e._id,s),children:e.title},e._id))]})]})}),(0,M.jsx)(u.A,{xs:2,md:6,className:"",children:((null===e||void 0===e?void 0:e.pricings)||[]).map((e,n)=>(0,M.jsxs)("div",{className:"d-flex gap-4",children:[(0,M.jsxs)("div",{className:"mt-auto",children:[(0,M.jsx)(c.A,{size:"sm",children:"Session"}),(0,M.jsxs)(h.A,{bsSize:"sm",type:"select",required:!0,value:e.session,onChange:e=>j("offline",s,"session",e.target.value,n),children:[(0,M.jsx)("option",{value:"",selected:!0,disabled:!0,hidden:!0,children:"Choose here"}),F.map(e=>(0,M.jsxs)("option",{value:e,disabled:p(e,s,"offline",s,n),children:[e," min"]},e))]})]}),(0,M.jsxs)("div",{className:"mt-auto",children:[(0,M.jsx)(c.A,{size:"sm",children:"Session Price"}),(0,M.jsx)(h.A,{bsSize:"sm",type:"text",required:!0,value:e.price,onChange:e=>j("offline",s,"price",e.target.value,n),onKeyPress:e=>{/[0-9]/.test(e.key)||"Backspace"===e.key||e.preventDefault()}})]})]},n))}),(0,M.jsx)(u.A,{xs:2,className:"d-flex flex-col",children:(0,M.jsx)(x.A,{size:"sm",onClick:()=>{return e=s,void a(s=>(0,t.A)((0,t.A)({},s),{},{offline:s.offline.filter((s,n)=>n!==e)}));var e},color:"danger",outline:!0,type:"button",className:"mt-auto",children:(0,M.jsx)("i",{className:"ri-close-circle-line font-size-20 mt-auto"})})})]},s)),(0,M.jsx)("button",{onClick:()=>{a(e=>(0,t.A)((0,t.A)({},e),{},{offline:[...e.offline,{center:"",pricings:[{session:"",price:""},{session:"",price:""}]}]}))},type:"button",className:"btn d-block btn-primary btn-sm",children:"Add"})]})]}),(0,M.jsx)("div",{className:"d-flex justify-content-end my-4",children:(0,M.jsx)("button",{type:"submit",className:"btn btn-secondary btn-sm",children:"Save"})})]})})});var O=n(55300),_=n(91364);const q=["id"],R=e=>{let{date:s,startHour:n=0,startMinutes:i=0,endHour:t=0,endMinutes:l=0}=e;const a=n>0?(0,w.A)((0,S.A)((0,N.A)(new Date(s),0),n),i+15||0):(0,k.A)(new Date(s)),r=t>0?(0,w.A)((0,S.A)((0,N.A)(new Date(s),0),t),l-15||0):(0,T.A)(new Date(s)),d=[];let o=a;for(;o<=r;)d.push({label:(0,C.A)(o,"h:mm a"),value:o.toISOString()}),o=(0,D.A)(o,15);return d},U=(0,l.memo)(e=>{let{value:s,onChange:n,options:i,label:l,required:d,generateTimes:o}=e;return(0,M.jsxs)("div",{className:"position-relative",children:[(0,M.jsxs)(c.A,{className:"form-label",children:[l,d&&(0,M.jsx)("span",{className:"text-danger",children:"*"})]}),(0,M.jsx)(r.Ay,{required:d,components:a.c,defaultValue:s,styles:{menuPortal:e=>(0,t.A)((0,t.A)({},e),{},{zIndex:9999})},menuShouldScrollIntoView:!0,menuPortalTarget:document.body,menuPosition:"fixed",onChange:n,options:i})]})}),L=(0,l.memo)(e=>{let{sch:s,idx:n,i:i,date:t,generateTimes:a,handleScheduleChange:r,removeSchedule:d,userCenters:o}=e;const v=(0,l.useMemo)(()=>a({date:t.date,endHour:s.endTime?new Date(s.endTime).getHours():0,endMinutes:s.endTime?new Date(s.endTime).getMinutes():0}),[t.date,s.endTime]),g=(0,l.useMemo)(()=>a({date:t.date,startHour:s.startTime?new Date(s.startTime).getHours():0,startMinutes:s.startTime?new Date(s.startTime).getMinutes():0}),[t.date,s.startTime]);return(0,M.jsxs)(m.A,{children:[(0,M.jsx)(u.A,{xs:3,children:(0,M.jsx)(U,{value:{label:s.startTime&&(0,C.A)(new Date(s.startTime),"h:mm a"),value:s.startTime&&(0,N.A)((0,P.A)(new Date(s.startTime),0),0).toISOString()},onChange:e=>{const s=new Date(t.date),l=new Date(e.value);s.setHours(l.getHours(),l.getMinutes(),l.getSeconds(),0),r(i,n,"startTime",s)},options:v,label:"Start Time",required:!0})}),(0,M.jsx)(u.A,{xs:3,children:(0,M.jsx)(U,{value:{label:s.endTime&&(0,C.A)(new Date(s.endTime),"h:mm a"),value:s.endTime&&(0,N.A)((0,P.A)(new Date(s.endTime),0),0).toISOString()},onChange:e=>{const s=new Date(t.date),l=new Date(e.value);s.setHours(l.getHours(),l.getMinutes(),l.getSeconds(),0),r(i,n,"endTime",s)},options:g,label:"End Time",required:!0})}),(0,M.jsx)(u.A,{xs:3,className:"d-flex align-items-end",children:(0,M.jsxs)("div",{className:"mt-auto",children:[(0,M.jsx)(c.A,{size:"sm",children:"Type"}),(0,M.jsxs)(h.A,{bsSize:"sm",type:"select",value:s.type,onChange:e=>r(i,n,"type",e.target.value),children:[(0,M.jsx)("option",{value:"",selected:!0,disabled:!0,hidden:!0,children:"Choose here"}),(["ONLINE","OFFLINE"]||0).map((e,s)=>(0,M.jsx)("option",{id:e,value:e,children:e},s))]})]})}),"OFFLINE"===s.type&&(0,M.jsx)(u.A,{xs:2,children:(0,M.jsxs)("div",{className:"",children:[(0,M.jsx)(c.A,{size:"sm",children:"Centers"}),(0,M.jsxs)(h.A,{bsSize:"sm",type:"select",value:s.center,onChange:e=>{const s=e.target.options[e.target.selectedIndex].getAttribute("id");r(i,n,"center",s)},children:[(0,M.jsx)("option",{value:"",selected:!0,disabled:!0,hidden:!0,children:"Choose here"}),(o||[]).map((e,s)=>(0,M.jsx)("option",{id:e._id,value:e._id,children:e.title},s))]})]})}),(0,M.jsx)(u.A,{xs:1,className:"d-flex flex-col",children:(0,M.jsx)(x.A,{size:"sm",onClick:()=>d(i,n),color:"danger",outline:!0,type:"button",className:"mt-auto",children:(0,M.jsx)("i",{className:"".concat(0===n?"ri-eraser-line":"ri-close-circle-line"," font-size-20 mt-auto")})})})]},s.id)}),V=(0,l.memo)(e=>{let{date:s,i:n,schedule:i,generateTimes:t,handleScheduleChange:l,addSchedule:a,removeSchedule:r,userCenters:d}=e;return(0,M.jsxs)("div",{className:i.length>1&&n!==i.length-1?"border-bottom border-dark overflow-auto pb-2 d-flex gap-4 align-items-center mb-3 m-auto":"d-flex gap-4 align-items-end mb-3 overflow-auto m-auto",style:{width:"800px"},children:[(0,M.jsxs)("time",{className:"bg-secondary text-nowrap text-center rounded text-white p-2","aria-label":s.date.toDateString(),children:[(0,M.jsx)("span",{children:(0,C.A)(s.date,"dd MMM yyyy")}),(0,M.jsx)("span",{className:"d-block",children:(0,C.A)(s.date,"EEEE")})]}),(0,M.jsx)("div",{className:"flex-grow-1",children:(s.workingSchedule||[]).map((e,i)=>(0,M.jsx)(L,{sch:e,idx:i,i:n,date:s,generateTimes:t,handleScheduleChange:l,removeSchedule:r,userCenters:d},e.id))}),(0,M.jsx)("button",{onClick:()=>a(n),type:"button",className:"btn d-block btn-primary btn-sm",children:"Add"})]},s.id)}),W=(0,b.Ng)(e=>({appointments:e.Booking.data,userSchedule:e.User.incrementalSchedule,weeklySchedule:e.User.weeklySchedule,userCenters:e.User.userCenters,sessionPricing:e.User.sessionPricing,centers:e.Center.data,currentEvent:e.Booking.event,patients:e.Patient.allPatients,centerAccess:e.User.centerAccess}))(e=>{let{isOpen:s,toggle:n,doctor:a,userCenters:r,sessionPricing:m,userSchedule:u,weeklySchedule:x}=e;const w=(0,b.wA)(),[S,N]=(0,l.useState)(!1),[k,T]=(0,l.useState)(!1),[D,P]=(0,l.useState)(0),[I,F]=(0,l.useState)(0),[U,L]=(0,l.useState)({online:[{session:"",price:""}],offline:[{center:"",pricings:[{session:"",price:""},{session:"",price:""}]}]}),[W,B]=(0,l.useState)([]),[K,Y]=(0,l.useState)([]);console.log(K),(0,l.useEffect)(()=>{m&&L(m)},[m]);const G=new Date,J=(0,l.useMemo)(()=>(0,z.A)({start:G,end:(0,H.A)(G,29)}).map(e=>({id:(0,j.A)(),date:new Date(e.setHours(12,12,12,12)),workingSchedule:[{id:(0,j.A)(),type:"",startTime:"",endTime:"",center:null}]})),[G]),[Q,X]=(0,l.useState)(J),Z=(0,l.useCallback)((e,s,n,i)=>{X(l=>l.map((l,a)=>a===e?(0,t.A)((0,t.A)({},l),{},{workingSchedule:l.workingSchedule.map((e,l)=>l===s?(0,t.A)((0,t.A)((0,t.A)({},e),"ONLINE"===i&&{center:null}),{},{[n]:i}):e)}):l))},[]),$=(0,l.useCallback)(e=>{X(s=>s.map((s,n)=>n===e?(0,t.A)((0,t.A)({},s),{},{workingSchedule:[...s.workingSchedule,{id:(0,j.A)(),type:"",startTime:"",endTime:"",center:""}]}):s))},[]),ee=(0,l.useCallback)((e,s)=>{X(n=>n.map((n,i)=>i===e?(0,t.A)((0,t.A)({},n),{},{workingSchedule:0===s?n.workingSchedule.map((e,n)=>n===s?{id:(0,j.A)(),type:"",startTime:"",endTime:"",center:""}:e):n.workingSchedule.filter((e,n)=>n!==s)}):n))},[]),se=((0,l.useCallback)(e=>{X(s=>s.map(s=>(0,t.A)((0,t.A)({},s),{},{workingSchedule:s.workingSchedule.map(s=>(0,t.A)({},s.startTime?s:e))})))},[]),(0,l.useCallback)(async e=>{const s={userId:e.user,workingSchedulesData:(t=e.workingSchedule,t.map(e=>({date:e.date,workingSchedule:e.workingSchedule.filter(e=>""!==e.startTime&&""!==e.endTime).map(e=>{let{id:s}=e;return(0,i.A)(e,q)})})).filter(e=>e.workingSchedule.length>0))};var t;w((0,y.cTc)(s)),n()},[w,n])),ne=(0,o.Wx)({enableReinitialize:!0,initialValues:{user:null===a||void 0===a?void 0:a._id,workingSchedule:Q},validationSchema:d.Ik({user:d.Yj().required("User ID is required")}),onSubmit:se}),ie=(0,l.useCallback)(()=>{if((null===u||void 0===u?void 0:u.length)>0){let e=Q;e=e.map(e=>{const s=u.find(s=>s.date&&(0,C.A)(new Date(s.date),"dd MMM yyyy")===(0,C.A)(new Date(e.date),"dd MMM yyyy"));return s?(0,t.A)((0,t.A)({},s),{},{id:(0,j.A)(),date:e.date}):e}),X(e)}else X((0,z.A)({start:G,end:(0,H.A)(G,29)}).map(e=>({id:(0,j.A)(),date:new Date(e.setHours(12,12,12,12)),workingSchedule:[{id:(0,j.A)(),type:"",startTime:"",endTime:"",center:null}]})))},[u]);(0,l.useEffect)(()=>{ie()},[s,u]),(0,l.useEffect)(()=>{console.log(a,"run change listing");(async()=>{if(null!==a&&void 0!==a&&a._id){var e,s;const n=await w((0,y.v7m)(a._id));console.log(n,"resultAction of listing"),N(null===n||void 0===n||null===(e=n.payload)||void 0===e||null===(s=e.user)||void 0===s?void 0:s.isHideFromSearch)}})()},[w,null===a||void 0===a?void 0:a._id,k]);(0,l.useEffect)(()=>{a&&N(null===a||void 0===a?void 0:a.isHideFromSearch)},[a]);const te=(0,l.useMemo)(()=>(0,M.jsx)(v.A,{onSubmit:e=>(e.preventDefault(),ne.handleSubmit(),!1),className:"needs-validation m-auto",action:"#",children:(0,M.jsxs)("div",{children:[(0,M.jsx)("div",{className:"h-500 overflow-auto",children:Q.map((e,s)=>(0,M.jsx)(V,{date:e,i:s,schedule:Q,generateTimes:R,handleScheduleChange:Z,addSchedule:$,removeSchedule:ee,userCenters:r},e.id))}),(0,M.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,M.jsxs)("div",{className:"d-flex gap-2",children:[(0,M.jsx)("span",{className:"text-black",style:{fontSize:"16px",fontWeight:700},children:"Website Listing:"}),(0,M.jsxs)(g.A,{switch:!0,children:[(0,M.jsx)(h.A,{type:"switch",id:"activeSwitch",checked:!S,style:{boxShadow:"none",outline:"none",border:"none",height:"18px",width:"40px"},onChange:e=>(async e=>{if(console.log(e,"website listing"),!a)return;const s=e.target.checked;N(s),console.log(s,"newStatus");try{await w((0,_.Av)({userId:a._id})).unwrap(),T(!k)}catch(n){console.error("Update failed:",n)}})(e)}),(0,M.jsx)(c.A,{for:"activeSwitch",check:!0})]})]}),(0,M.jsx)("button",{type:"submit",className:"btn btn-secondary btn-sm",children:"Save"})]})]})}),[Q,Z,$,ee,r,ne]);return(0,M.jsxs)(l.Fragment,{children:[(0,M.jsxs)(f.A,{pills:!0,className:"mb-4 justify-content-center",children:[(0,M.jsx)(p.A,{onClick:()=>P(0),children:(0,M.jsx)(A.A,{active:0===D,href:"#",children:"Schedule"})}),(0,M.jsx)(p.A,{onClick:()=>P(1),children:(0,M.jsx)(A.A,{active:1===D,href:"#",children:"Pricing"})})]}),1===D?(0,M.jsx)(E,{pricing:U,setPricing:L,sessionPricing:m,doctor:a,toggle:n}):(0,M.jsxs)("div",{children:[(0,M.jsxs)(f.A,{pills:!0,className:"mb-4 justify-content-center",children:[(0,M.jsx)(p.A,{onClick:()=>F(0),children:(0,M.jsx)(A.A,{active:0===I,href:"#",children:"Incremental"})}),(0,M.jsx)(p.A,{onClick:()=>F(1),children:(0,M.jsx)(A.A,{active:1===I,href:"#",children:"Weekly"})})]}),0===I?(0,M.jsx)(M.Fragment,{children:te}):(0,M.jsx)(O.A,{doctor:a,userCenters:r,toggle:n,weeklySchedule:x})]})]})})},55300:(e,s,n)=>{n.d(s,{A:()=>k});var i=n(89379),t=n(65043),l=(n(88682),n(12327)),a=n(22345),r=n(26259),d=n(6221),o=n(72679),c=n(7493),m=n(78639),u=n(53536),h=n.n(u),x=n(15175),v=n(45627),g=n(22166),f=n(98093),p=n(2364),A=n(3929),b=n(14028),j=n(10836),y=n(70579);const w=e=>{const{isSelected:s,innerRef:n,innerProps:t,children:l}=e;return(0,y.jsx)("div",(0,i.A)((0,i.A)({ref:n},t),{},{className:"p-2 ".concat(s?"bg-primary text-white":"hover:bg-light"),children:l}))},S=e=>{let{value:s,onChange:n,options:t,label:l,required:a,disabled:r,placeholder:d="Choose time"}=e;return(0,y.jsxs)("div",{className:"position-relative",children:[(0,y.jsxs)(c.A,{className:"form-label mb-1 fw-medium",children:[l,a&&(0,y.jsx)("span",{className:"text-danger ms-1",children:"*"})]}),(0,y.jsx)(p.Ay,{required:a,isDisabled:r,components:{Option:w},value:s,styles:{control:(e,s)=>(0,i.A)((0,i.A)({},e),{},{minHeight:"36px",height:"36px",fontSize:"0.875rem",borderColor:s.isFocused?"#0d6efd":"#dee2e6",boxShadow:s.isFocused?"0 0 0 0.25rem rgba(13, 110, 253, 0.25)":"none","&:hover":{borderColor:s.isFocused?"#0d6efd":"#dee2e6"},backgroundColor:r?"#e9ecef":"white",borderRadius:"0.375rem"}),menuPortal:e=>(0,i.A)((0,i.A)({},e),{},{zIndex:9999}),option:(e,s)=>(0,i.A)((0,i.A)({},e),{},{padding:"8px 12px",backgroundColor:s.isSelected?"#0d6efd":s.isFocused?"#f8f9fa":"white",color:s.isSelected?"white":"#212529",cursor:"pointer","&:hover":{backgroundColor:s.isSelected?"#0d6efd":"#f8f9fa"}}),singleValue:e=>(0,i.A)((0,i.A)({},e),{},{color:"#212529"}),placeholder:e=>(0,i.A)((0,i.A)({},e),{},{color:"#6c757d"})},menuShouldScrollIntoView:!0,menuPortalTarget:document.body,menuPosition:"fixed",onChange:n,options:t,placeholder:d,isClearable:!1,classNamePrefix:"time-select"})]})},N=e=>{let{value:s,onChange:n,sessions:t,disabled:l,currentIndex:a,setSessionErrors:r,validateSessionOverlap:d}=e;const o=[{value:"OFFLINE",label:"Offline"},{value:"ONLINE",label:"Online"}];return(0,y.jsxs)("div",{className:"position-relative",children:[(0,y.jsxs)(c.A,{className:"form-label mb-1 fw-medium",children:["Session Type",(0,y.jsx)("span",{className:"text-danger ms-1",children:"*"})]}),(0,y.jsx)(p.Ay,{isDisabled:l,value:o.find(e=>e.value===s),onChange:e=>(e=>{const s=t[a];if(s.startTime&&s.endTime&&d(t,a,s.startTime,s.endTime,e))return;n(e)})(e.value),options:o,styles:{control:(e,s)=>(0,i.A)((0,i.A)({},e),{},{minHeight:"36px",height:"36px",fontSize:"0.875rem",borderColor:s.isFocused?"#0d6efd":"#dee2e6",boxShadow:s.isFocused?"0 0 0 0.25rem rgba(13, 110, 253, 0.25)":"none","&:hover":{borderColor:s.isFocused?"#0d6efd":"#dee2e6"},backgroundColor:l?"#e9ecef":"white",borderRadius:"0.375rem"}),menuPortal:e=>(0,i.A)((0,i.A)({},e),{},{zIndex:9999}),option:(e,s)=>(0,i.A)((0,i.A)({},e),{},{padding:"8px 12px",backgroundColor:s.isSelected?"#0d6efd":s.isFocused?"#f8f9fa":"white",color:s.isSelected?"white":"#212529",cursor:"pointer","&:hover":{backgroundColor:s.isSelected?"#0d6efd":"#f8f9fa"}})},menuShouldScrollIntoView:!0,menuPortalTarget:document.body,menuPosition:"fixed",placeholder:"Select type",isClearable:!1,classNamePrefix:"session-type-select"})]})},k=e=>{let{weeklySchedule:s,doctor:n,userCenters:i,toggle:u}=e;const p=(0,g.wA)(),[w,k]=(0,t.useState)(()=>{var e;return(null===s||void 0===s||null===(e=s.workingSchedule)||void 0===e?void 0:e.length)>0?h().cloneDeep(s.workingSchedule):[]}),[T,C]=(0,t.useState)({}),[D,P]=(0,t.useState)(""),z=(e,s)=>{let n=[...w];const i=e.target.name,t=parseInt(e.target.value);if("days"===i)if(n.forEach((e,i)=>{var l,a,r;if(i!==s&&(null===(l=e.center)||void 0===l?void 0:l._id)===(null===(a=n[s])||void 0===a||null===(r=a.center)||void 0===r?void 0:r._id)&&e.days.includes(t)){const s=e.days.filter(e=>e!==t);n[i].days=s}}),n[s][i].includes(t)){const e=n[s][i].includes(t)?n[s][i].filter(e=>e!==t):[...n[s][i]||[],t];n[s][i]=e}else n[s][i].includes(t)||(n[s][i]=[...n[s][i]||[],t]);k(n)};(0,t.useEffect)(()=>{var e;if(null!==n&&void 0!==n&&null!==(e=n.data)&&void 0!==e&&e.workingSchedule){const e=h().cloneDeep(n.data.workingSchedule.workingSchedule);k(e)}},[n]);const H=(e,s,n,i,t)=>{for(let l=0;l<e.length;l++){if(l===s)continue;const a=e[l];if(a.startTime&&a.endTime&&a.type===t){const e=new Date(a.startTime),s=new Date(a.endTime),t=new Date(n),l=new Date(i);if(t>=e&&t<s||l>e&&l<=s||t<=e&&l>=s)return!0}}return!1},I=(e,s,n)=>{let i=[...w];const t=e.target.name,l=e.target.value;if("startTime"===t||"endTime"===t){"startTime"===t||i[s].sessions[n].startTime,"endTime"===t||i[s].sessions[n].endTime,i[s].sessions[n].type}i[s].sessions[n][t]=l,k(i)};(0,x.A)({start:new Date((new Date).setHours(0)).setMinutes(0),end:new Date((new Date).setHours(23)).setMinutes(0)},{step:15});return(0,y.jsx)(t.Fragment,{children:(0,y.jsx)(d.A,{onSubmit:e=>(e.preventDefault(),(()=>{const e=w.find(e=>{var s;return 0===(null===e||void 0===e||null===(s=e.days)||void 0===s?void 0:s.length)});w.some(e=>e.sessions.some(e=>!e.type||!e.startTime||!e.endTime))?P("Please fill in all session details including type, start time, and end time"):e||p((0,f.rjY)({workingSchedule:w,user:null===n||void 0===n?void 0:n._id}))})(),!1),className:"needs-validation",action:"#",children:(0,y.jsxs)(l.A,{children:[(w||[]).map((e,s)=>{var n,d,u,h,x,g,f,p;return(0,y.jsxs)(t.Fragment,{children:[(0,y.jsx)(a.A,{xs:12,children:(0,y.jsxs)("div",{className:"mb-3",children:[(0,y.jsxs)("div",{className:"d-flex justify-content-between flex-wrap align-items-center mb-n4 mt-2",children:[" ",(0,y.jsxs)(c.A,{className:"form-label",children:["Days ",(0,y.jsx)("span",{className:"text-danger",children:"*"})]}),(0,y.jsx)(r.A,{onClick:()=>(e=>{const s=[...w];s.splice(e,1),k(s)})(s),color:"danger",size:"sm",children:(0,y.jsx)("i",{className:"ri-close-circle-line fs-9 text-white"})})]}),(0,y.jsxs)("div",{className:"d-flex flex-wrap",children:[(0,y.jsxs)("div",{className:"d-flex me-3 align-items-center mt-2",children:[(0,y.jsx)(o.A,{className:"me-2 mt-0",type:"checkbox",name:"days",value:1,onChange:e=>z(e,s),checked:null===(n=e.days)||void 0===n?void 0:n.includes(1)}),(0,y.jsx)(c.A,{className:"form-label fs-9 text-black mb-0",children:"Monday"})]}),(0,y.jsxs)("div",{className:"d-flex me-3 align-items-center mt-2",children:[(0,y.jsx)(o.A,{className:"me-2 mt-0",type:"checkbox",name:"days",value:2,onChange:e=>z(e,s),checked:null===(d=e.days)||void 0===d?void 0:d.includes(2)}),(0,y.jsx)(c.A,{className:"form-label fs-9 text-black mb-0",children:"Tuesday"})]}),(0,y.jsxs)("div",{className:"d-flex me-3 align-items-center mt-2",children:[(0,y.jsx)(o.A,{className:"me-2 mt-0",type:"checkbox",name:"days",value:3,onChange:e=>z(e,s),checked:null===(u=e.days)||void 0===u?void 0:u.includes(3)}),(0,y.jsx)(c.A,{className:"form-label fs-9 text-black mb-0",children:"Wednesday"})]}),(0,y.jsxs)("div",{className:"d-flex me-3 align-items-center mt-2",children:[(0,y.jsx)(o.A,{className:"me-2 mt-0",type:"checkbox",name:"days",value:4,onChange:e=>z(e,s),checked:null===(h=e.days)||void 0===h?void 0:h.includes(4)}),(0,y.jsx)(c.A,{className:"form-label fs-9 text-black mb-0",children:"Thursday"})]}),(0,y.jsxs)("div",{className:"d-flex me-3 align-items-center mt-2",children:[(0,y.jsx)(o.A,{className:"me-2 mt-0",type:"checkbox",name:"days",value:5,onChange:e=>z(e,s),checked:null===(x=e.days)||void 0===x?void 0:x.includes(5)}),(0,y.jsx)(c.A,{className:"form-label fs-9 text-black mb-0",children:"Friday"})]}),(0,y.jsxs)("div",{className:"d-flex me-3 align-items-center mt-2",children:[(0,y.jsx)(o.A,{className:"me-2 mt-0",type:"checkbox",name:"days",value:6,onChange:e=>z(e,s),checked:null===(g=e.days)||void 0===g?void 0:g.includes(6)}),(0,y.jsx)(c.A,{className:"form-label fs-9 text-black mb-0",children:"Saturday"})]}),(0,y.jsxs)("div",{className:"d-flex me-3 align-items-center mt-2",children:[(0,y.jsx)(o.A,{className:"me-2 mt-0",type:"checkbox",name:"days",value:0,onChange:e=>z(e,s),checked:null===(f=e.days)||void 0===f?void 0:f.includes(0)}),(0,y.jsx)(c.A,{className:"form-label fs-9 text-black mb-0",children:"Sunday"})]}),(0,y.jsxs)("div",{className:"mb-3 ms-md-3",children:[(0,y.jsx)(c.A,{size:"sm",children:"Centers"}),(0,y.jsxs)(o.A,{bsSize:"sm",type:"select",required:!0,value:e.center,onChange:e=>{const n=[...w];n[s].center=e.target.value,k(n)},children:[(0,y.jsx)("option",{value:"",selected:!0,disabled:!0,hidden:!0,children:"Choose here"}),(i||[]).map((e,s)=>(0,y.jsx)("option",{value:e._id,children:e.title},s))]})]})]})]})}),(0,y.jsxs)(m.A,{isTrue:(null===e||void 0===e||null===(p=e.days)||void 0===p?void 0:p.length)>0,children:[(0,y.jsx)(a.A,{xs:12,children:(0,y.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[(0,y.jsx)("h6",{className:"mb-0 text-primary",children:"Sessions"}),(0,y.jsxs)(r.A,{color:"light",size:"sm",className:"d-flex align-items-center",onClick:()=>{const e=[...w];e[s].sessions.push({startTime:"",endTime:"",type:""}),k(e)},children:[(0,y.jsx)("i",{className:"ri-add-line me-1"})," Add Session"]})]})}),(e.sessions||[]).map((n,i)=>(0,y.jsx)(a.A,{md:6,children:(0,y.jsx)("div",{className:"card shadow-sm mb-3",children:(0,y.jsxs)("div",{className:"card-body p-3",children:[(0,y.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[(0,y.jsxs)("div",{className:"d-flex align-items-center",children:[(0,y.jsx)("div",{className:"bg-primary text-white rounded-circle d-flex align-items-center justify-content-center me-2",style:{width:"28px",height:"28px"},children:i+1}),(0,y.jsxs)("h6",{className:"mb-0 text-primary fw-semibold",children:["Session ",i+1]})]}),(0,y.jsxs)("div",{className:"d-flex align-items-center",children:[(0,y.jsx)(N,{value:n.type,onChange:e=>{const n=[...w];n[s].sessions[i].type=e,k(n)},sessions:e.sessions,currentIndex:i,setSessionErrors:C,validateSessionOverlap:H}),i>0&&(0,y.jsx)(r.A,{color:"link",className:"p-0 text-danger opacity-75 hover-opacity-100 ms-2",onClick:()=>{const n=[...e.sessions];n.splice(i,1);const t=[...w];t[s].sessions=n,k(t)},children:(0,y.jsx)("i",{className:"ri-close-circle-line fs-5"})})]})]}),(0,y.jsxs)(l.A,{className:"g-3",children:[(0,y.jsx)(a.A,{xs:6,children:(0,y.jsx)(S,{value:n.startTime?{label:(0,v.A)(new Date(n.startTime),"hh:mm a"),value:(0,b.A)((0,A.A)(new Date(n.startTime),0),0).toISOString()}:null,onChange:e=>{if(e){const t=new Date(e.value),l=(0,v.A)(t,"HH:mm");if(n.endTime){if(l>=(0,v.A)(new Date(n.endTime),"HH:mm"))return}I({target:{name:"startTime",value:t}},s,i)}},options:(0,j.uA)({date:n.endTime||new Date,endHour:n.endTime?new Date(n.endTime).getHours():0,endMinutes:n.endTime?new Date(n.endTime).getMinutes():0}),label:"Start Time",required:!0,disabled:!n.type,placeholder:"start time"})}),(0,y.jsx)(a.A,{xs:6,children:(0,y.jsx)(S,{value:n.endTime?{label:(0,v.A)(new Date(n.endTime),"hh:mm a"),value:(0,b.A)((0,A.A)(new Date(n.endTime),0),0).toISOString()}:null,onChange:e=>{if(e){const t=new Date(e.value),l=(0,v.A)(t,"HH:mm");if(n.startTime){if(l<=(0,v.A)(new Date(n.startTime),"HH:mm"))return}I({target:{name:"endTime",value:t}},s,i)}},options:(0,j.uA)({date:n.startTime||new Date,startHour:n.startTime?new Date(n.startTime).getHours():0,startMinutes:n.startTime?new Date(n.startTime).getMinutes():0}),label:"End Time",required:!0,disabled:!n.type,placeholder:"End time"})})]})]})})},i))]})]},s)}),D&&(0,y.jsx)("div",{className:"mt-2",children:(0,y.jsxs)("small",{className:"text-danger d-flex align-items-center",children:[(0,y.jsx)("i",{className:"ri-error-warning-line me-1"}),D]})}),(0,y.jsx)(a.A,{xs:12,children:(0,y.jsx)("div",{className:"text-end my-3",children:(0,y.jsx)("button",{onClick:()=>{k([...w,{center:null,days:[],sessions:[{startTime:"",endTime:"",type:""}]}])},type:"button",className:"btn btn-primary btn-sm btn-outline ms-auto",children:"Add more timings"})})}),(0,y.jsx)(a.A,{xs:12,children:(0,y.jsx)("div",{className:"d-flex justify-content-end mt-3",children:(0,y.jsx)("button",{type:"submit",className:"btn btn-primary btn-sm",children:"Save"})})})]})})})}}}]);
//# sourceMappingURL=9641.8ce49d6b.chunk.js.map