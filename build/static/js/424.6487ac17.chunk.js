"use strict";(self.webpackChunkjagruti_software=self.webpackChunkjagruti_software||[]).push([[424],{24410:(e,s,t)=>{t.d(s,{A:()=>c});var n=t(65043),i=t(35475),a=t(12327),l=t(22345),r=t(70579);const c=e=>{let{title:s,pageTitle:t}=e;return(0,r.jsx)(n.Fragment,{children:(0,r.jsx)(a.A,{children:(0,r.jsx)(l.A,{xs:12,children:(0,r.jsxs)("div",{className:"page-title-box p-3 d-flex flex-column flex-sm-row align-items-start align-items-sm-center justify-content-between gap-2",children:[(0,r.jsx)("h4",{className:"mb-2 mb-sm-0",children:s}),(0,r.jsx)("div",{className:"page-title-right",children:(0,r.jsxs)("ol",{className:"breadcrumb m-0",children:[(0,r.jsx)("li",{className:"breadcrumb-item",children:(0,r.jsx)(i.N_,{to:"#",children:t})}),(0,r.jsx)("li",{className:"breadcrumb-item active",children:s})]})})]})})})})}},90424:(e,s,t)=>{t.r(s),t.d(s,{default:()=>D});var n=t(65043),i=t(24410),a=t(89379),l=t(80045),r=t(88682),c=t(6221),d=t(12327),o=t(22345),m=t(72679),h=t(26259),x=t(23194),u=t(80899),j=t(86897),b=t(22166),p=t(98093),g=t(415),v=t(24963),A=t(70579);const N=e=>{let{toggle:s}=e;const t=(0,b.wA)(),[i,l]=(0,n.useState)([]),[r,N]=(0,n.useState)({}),[y,f]=(0,n.useState)(!1);(0,n.useEffect)(()=>{f(Object.keys(r).length>0)},[r]);const C=function(e,s){const t=(0,n.useRef)(null);return function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];clearTimeout(t.current),t.current=setTimeout(()=>{e(...i)},s)}}(async(e,s,n)=>{if(s&&n)try{const i=await t((0,v.sV)({name:s,strength:n})).unwrap();i.exists?N(s=>(0,a.A)((0,a.A)({},s),{},{[e]:i.message})):N(s=>{const t=(0,a.A)({},s);return delete t[e],t})}catch(i){console.error(i)}else N(s=>{const t=(0,a.A)({},s);return delete t[e],t})},500),S=e=>{const s=[...i],t=e.target.name,n=e.target.value,a=parseInt(e.target.id,10);s[a][t]=n,l(s),"strength"===t?C(a,s[a].name,n):"name"===t&&s[a].strength&&C(a,n,s[a].strength)},w=(0,j.Wx)({enableReinitialize:!0,initialValues:{medicines:i},validationSchema:u.Ik({medicines:u.YO().test("notEmpty","At least one medicine is required",e=>!(!e||!e.length))}),onSubmit:()=>{y?alert("Fix duplicate strengths before submitting"):(t((0,p.wT9)(i)),l([]),s(),w.resetForm())}});return(0,A.jsx)(c.A,{onSubmit:e=>(e.preventDefault(),w.handleSubmit(),!1),className:"needs-validation",children:(0,A.jsxs)(d.A,{className:"ps-3 pe-3",children:[(0,A.jsxs)(o.A,{className:"mb-3 pb-2 border-bottom",xs:2,md:2,children:["Name",(0,A.jsx)("span",{className:"text-danger",children:"*"})]}),(0,A.jsxs)(o.A,{className:"mb-3 pb-2 border-bottom",xs:2,md:1,children:["Type",(0,A.jsx)("span",{className:"text-danger",children:"*"})]}),(0,A.jsx)(o.A,{className:"mb-3 pb-2 border-bottom",xs:2,md:1,children:"Strength"}),(0,A.jsx)(o.A,{className:"mb-3 pb-2 border-bottom",xs:2,md:1,children:"Unit"}),(0,A.jsx)(o.A,{className:"mb-3 pb-2 border-bottom",xs:4,md:2,children:"Instruction"}),(0,A.jsx)(o.A,{className:"mb-3 pb-2 border-bottom",xs:4,md:2,children:"Composition"}),(0,A.jsx)(o.A,{className:"mb-3 pb-2 border-bottom",xs:4,md:1,children:"Quantity"}),(0,A.jsx)(o.A,{className:"mb-3 pb-2 border-bottom",xs:4,md:1,children:"Unit price"}),(0,A.jsx)(o.A,{className:"mb-3 pb-2 border-bottom",xs:4,md:1}),(i||[]).map((e,s)=>(0,A.jsxs)(n.Fragment,{children:[(0,A.jsx)(o.A,{xs:2,md:2,children:(0,A.jsx)("div",{className:"mb-3 w-5",children:(0,A.jsx)(m.A,{required:!0,bsSize:"sm",id:s,onChange:S,name:"name",value:e.name,type:"text",className:"form-control"})})}),(0,A.jsx)(o.A,{xs:3,md:2,children:(0,A.jsx)("div",{className:"mb-3 w-5",children:(0,A.jsxs)(m.A,{bsSize:"sm",id:s,onChange:S,name:"type",value:e.type,type:"select",className:"form-control",children:[(0,A.jsx)("option",{value:"",selected:!0,disabled:!0,hidden:!0,children:"Choose Type"}),(g.qH||[]).map((e,s)=>(0,A.jsx)("option",{value:e,className:"text-cap",children:e},s+e))]})})}),(0,A.jsx)(o.A,{xs:2,md:1,children:(0,A.jsx)("div",{className:"mb-3",children:(0,A.jsx)(m.A,{bsSize:"sm",id:s,onChange:S,name:"strength",value:e.strength,type:"text",invalid:!!r[s]})})}),(0,A.jsx)(o.A,{xs:3,md:2,children:(0,A.jsx)("div",{className:"mb-3",children:(0,A.jsxs)("div",{class:"form-group",children:[(0,A.jsxs)(m.A,{bsSize:"sm",id:s,onChange:S,name:"unit",value:e.unit,type:"select",className:"form-control",children:[(0,A.jsx)("option",{value:"",selected:!0,disabled:!0,hidden:!0,children:"Choose Unit"}),(g.ET||[]).map((e,s)=>(0,A.jsx)("option",{children:e},s+e))]}),(0,A.jsx)("datalist",{id:"unit-options",children:(g.ET||[]).map((e,s)=>(0,A.jsx)("option",{value:e,className:"text-cap"},s+e))})]})})}),(0,A.jsx)(o.A,{xs:3,md:2,children:(0,A.jsx)("div",{className:"mb-3",children:(0,A.jsx)(m.A,{bsSize:"sm",id:s,onChange:S,name:"instruction",value:e.instruction,type:"textarea",rows:"1",className:"form-control"})})}),(0,A.jsx)(o.A,{xs:3,md:2,children:(0,A.jsx)("div",{className:"mb-3",children:(0,A.jsx)(m.A,{bsSize:"sm",id:s,required:!0,onChange:S,name:"composition",value:e.composition,type:"textarea",rows:"1",className:"form-control"})})}),(0,A.jsx)(o.A,{xs:3,md:1,children:(0,A.jsx)("div",{className:"mb-3",children:(0,A.jsx)(m.A,{bsSize:"sm",id:s,required:!0,onChange:S,name:"quantity",value:e.quantity,type:"number",rows:"1",className:"form-control"})})}),(0,A.jsx)(o.A,{xs:3,md:1,children:(0,A.jsx)("div",{className:"mb-3",children:(0,A.jsx)(m.A,{bsSize:"sm",id:s,required:!0,onChange:S,name:"unitPrice",value:e.unitPrice,type:"number",rows:"1",className:"form-control"})})}),(0,A.jsx)(o.A,{xs:1,md:1,children:(0,A.jsx)(h.A,{size:"sm",onClick:()=>(e=>{const s=[...i];s.splice(e,1),l(s),N(s=>{const t=(0,a.A)({},s);return delete t[e],t})})(s),color:"danger",children:(0,A.jsx)("i",{className:"ri-delete-bin-6-line fs-14 text-white"})})})]},s)),(0,A.jsx)(o.A,{xs:12,className:"mb-3",children:w.touched.medicines&&w.errors.medicines?(0,A.jsx)(x.A,{type:"invalid",className:"d-block",children:w.errors.medicines}):null}),(0,A.jsx)(o.A,{children:(0,A.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,A.jsx)(h.A,{size:"sm",type:"button",color:"secondary",outline:!0,onClick:()=>{l([...i,{name:"",type:"",strength:"",unit:"",instruction:"",composition:"",quantity:"",unitPrice:""}])},children:"Add"}),(0,A.jsx)(h.A,{size:"sm",type:"submit",color:"primary",outline:!0,disabled:y||0===i.length,children:"Save"})]})})]})})},y=["modal","toggle"],f=e=>{let{modal:s,toggle:t}=e,i=(0,l.A)(e,y);return(0,A.jsx)(n.Fragment,{children:(0,A.jsx)(r.A,{size:"xl",isOpen:s,toggle:t,centered:!0,title:"Add Medicine",children:(0,A.jsx)(N,(0,a.A)({toggle:t},i))})})};var C=t(18353),S=t(98288),w=t(11387);const z=e=>{let{toggleForm:s,toggleCSV:t,setSearchItem:i}=e;const[a,l]=(0,n.useState)("");return(0,n.useEffect)(()=>{const e=setTimeout(()=>{i(a)},500);return()=>clearTimeout(e)},[a,i]),(0,A.jsx)(C.A,{className:"p-3 bg-white",children:(0,A.jsxs)(d.A,{className:"g-2 align-items-center",children:[(0,A.jsx)(o.A,{sm:4,children:(0,A.jsxs)(S.A,{children:[(0,A.jsx)(m.A,{type:"text",value:a,onChange:e=>l(e.target.value),placeholder:"Search for name"}),(0,A.jsx)(w.A,{children:(0,A.jsx)("i",{className:"ri-search-line"})})]})}),(0,A.jsx)(o.A,{className:"col-sm-auto me-auto",children:(0,A.jsx)(h.A,{color:"info",className:"text-white",onClick:t,children:(0,A.jsx)("i",{className:"ri-file-paper-2-line"})})}),(0,A.jsx)(o.A,{className:"col-sm-auto ms-auto",children:(0,A.jsxs)(h.A,{color:"success",className:"text-white",onClick:s,children:[(0,A.jsx)("i",{className:"ri-add-fill me-1 align-bottom"})," Add Medicine"]})})]})})};var P=t(7867),k=t(3655),M=t(91036);const q=e=>{let{updateMedicine:s,setUpdateMedicine:t}=e;const i=(0,b.wA)(),a=null===s||void 0===s?void 0:s.formData,[l,r]=(0,n.useState)(""),N=function(e,s){const t=(0,n.useRef)(null);return function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];clearTimeout(t.current),t.current=setTimeout(()=>{e(...i)},s)}}(async(e,s,t)=>{if(e&&s)try{const t=await i((0,v.sV)({name:e,strength:s,id:null===a||void 0===a?void 0:a._id})).unwrap();t.exists?r(t.message):r("")}catch(n){console.error(n)}},500),y=(0,j.Wx)({enableReinitialize:!0,initialValues:{id:(null===a||void 0===a?void 0:a._id)||"",name:(null===a||void 0===a?void 0:a.name)||"",type:(null===a||void 0===a?void 0:a.type)||"",strength:(null===a||void 0===a?void 0:a.strength)||"",unit:(null===a||void 0===a?void 0:a.unit)||"",instruction:(null===a||void 0===a?void 0:a.instruction)||"",composition:(null===a||void 0===a?void 0:a.composition)||"",quantity:(null===a||void 0===a?void 0:a.quantity)||"",unitPrice:(null===a||void 0===a?void 0:a.unitPrice)||""},validationSchema:u.Ik({name:u.Yj().required("Please Enter Medicine Name")}),onSubmit:e=>{l?M.oR.errror("Fix duplicate strength before saving"):(i((0,p.EH)(e)),t({isForm:!1,formIndex:void 0,formData:void 0}),y.resetForm())}});return(0,A.jsx)(n.Fragment,{children:(0,A.jsx)(c.A,{onSubmit:e=>(e.preventDefault(),y.handleSubmit(),!1),className:"needs-validation",action:"#",children:(0,A.jsxs)(d.A,{className:"align-items-center",children:[(0,A.jsxs)(o.A,{className:"mb-3 pb-2 border-bottom",xs:2,md:2,children:[(0,A.jsx)(m.A,{onChange:e=>{y.handleChange(e),y.values.strength&&N(e.target.value,y.values.strength,y.values.id)},name:"name",onBlur:y.handleBlur,value:y.values.name||"",bsSize:"sm"}),y.touched.name&&y.errors.name?(0,A.jsx)(x.A,{type:"invalid",className:"d-block",children:y.errors.name}):null]}),(0,A.jsx)(o.A,{className:"mb-3 pb-2 border-bottom",xs:2,md:2,children:(0,A.jsxs)(m.A,{className:"bg-white",onChange:y.handleChange,name:"type",type:"select",onBlur:y.handleBlur,value:y.values.type||"",bsSize:"sm",children:[(0,A.jsx)("option",{value:"",selected:!0,disabled:!0,hidden:!0,children:"Choose Type"}),(g.qH||[]).map((e,s)=>(0,A.jsx)("option",{value:e,className:"text-cap",children:e},s+e))]})}),(0,A.jsxs)(o.A,{className:"mb-3 pb-2 border-bottom",xs:2,md:2,children:[(0,A.jsx)(m.A,{onChange:e=>{y.handleChange(e),N(y.values.name,e.target.value,y.values.id)},name:"strength",onBlur:y.handleBlur,value:y.values.strength||"",bsSize:"sm",invalid:!!l}),l&&(0,A.jsx)(x.A,{className:"d-block",children:l})]}),(0,A.jsx)(o.A,{className:"mb-3 pb-2 border-bottom",xs:2,md:2,children:(0,A.jsxs)(m.A,{className:"bg-white",onChange:y.handleChange,name:"unit",type:"select",onBlur:y.handleBlur,value:y.values.unit||"",bsSize:"sm",children:[(0,A.jsx)("option",{value:"",selected:!0,disabled:!0,hidden:!0,children:"Choose Unit"}),(g.ET||[]).map((e,s)=>(0,A.jsx)("option",{children:e},s+e))]})}),(0,A.jsx)(o.A,{className:"mb-3 pb-2 border-bottom",xs:4,md:3,children:(0,A.jsx)(m.A,{onChange:y.handleChange,name:"instruction",onBlur:y.handleBlur,value:y.values.instruction||"",type:"textarea",rows:"1",bsSize:"sm"})}),(0,A.jsx)(o.A,{className:"mb-3 pb-2 border-bottom",xs:4,md:3,children:(0,A.jsx)(m.A,{onChange:y.handleChange,name:"composition",onBlur:y.handleBlur,value:y.values.composition||"",type:"textarea",rows:"1",bsSize:"sm"})}),(0,A.jsx)(o.A,{className:"mb-3 pb-2 border-bottom",xs:4,md:3,children:(0,A.jsx)(m.A,{onChange:y.handleChange,name:"quantity",onBlur:y.handleBlur,value:y.values.quantity||"",type:"textarea",rows:"1",bsSize:"sm"})}),(0,A.jsx)(o.A,{className:"mb-3 pb-2 border-bottom",xs:4,md:3,children:(0,A.jsx)(m.A,{onChange:y.handleChange,name:"unitPrice",onBlur:y.handleBlur,value:y.values.unitPrice||"",type:"textarea",rows:"1",bsSize:"sm"})}),(0,A.jsxs)(o.A,{className:"mb-3 pb-2 border-bottom align-items-end d-flex",xs:4,md:1,children:[(0,A.jsx)(h.A,{type:"button",onClick:()=>{t({isForm:!1,formIndex:void 0,formData:void 0})},className:"me-3",size:"sm",color:"danger",outline:!0,children:(0,A.jsx)("i",{className:"ri-close-circle-line fs-5"})}),(0,A.jsx)(h.A,{type:"submit",size:"sm",color:"success",disabled:!!l,children:(0,A.jsx)("i",{className:"ri-check-line fs-5"})})]})]})})})},F=(0,b.Ng)(e=>({medicines:e.Medicine.data,totalCount:e.Medicine.totalCount}))(e=>{let{medicines:s,totalCount:t,setDeleteMedicine:i,toggleDeleteModal:a,searchItem:l,currentPage:r,itemsPerPage:c,onPageChange:x,onItemsPerPageChange:u}=e;const[j,b]=(0,n.useState)({isForm:!1,formIndex:void 0,formData:void 0}),p=Math.ceil(t/c);return(0,A.jsxs)("div",{className:"p-4 bg-light rounded shadow-sm",children:[(0,A.jsxs)(d.A,{className:"mb-3 align-items-center",children:[(0,A.jsx)(o.A,{xs:"auto",children:(0,A.jsx)(m.A,{type:"select",value:c,onChange:e=>u(Number(e.target.value)),style:{width:"120px"},children:[5,10,25,50].map(e=>(0,A.jsx)("option",{value:e,children:e},e))})}),(0,A.jsxs)(o.A,{className:"text-end text-muted",children:["Page ",r," of ",p]})]}),(0,A.jsxs)(k.A,{bordered:!0,hover:!0,className:"bg-white",children:[(0,A.jsx)("thead",{className:"table-primary text-center",children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{children:"Name"}),(0,A.jsx)("th",{children:"Type"}),(0,A.jsx)("th",{children:"Strength"}),(0,A.jsx)("th",{children:"Unit"}),(0,A.jsx)("th",{children:"Expiry"}),(0,A.jsx)("th",{children:"Instruction"}),(0,A.jsx)("th",{children:"Composition"}),(0,A.jsx)("th",{children:"Quantity"}),(0,A.jsx)("th",{children:"Unit Price"}),(0,A.jsx)("th",{children:"Actions"})]})}),(0,A.jsx)("tbody",{children:(s||[]).filter(e=>e.name.toLowerCase().includes(l.toLowerCase())).map((e,s)=>(0,A.jsx)("tr",{children:j.isForm&&j.formIndex===s?(0,A.jsx)("td",{colSpan:"10",children:(0,A.jsx)(q,{updateMedicine:j,setUpdateMedicine:b})}):(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)("td",{className:"text-capitalize fw-semibold text-primary",children:e.name}),(0,A.jsx)("td",{children:e.type||""}),(0,A.jsx)("td",{children:e.strength||""}),(0,A.jsx)("td",{children:e.unit||""}),(0,A.jsx)("td",{children:e.expiry||""}),(0,A.jsx)("td",{children:e.instruction||""}),(0,A.jsx)("td",{children:e.composition||""}),(0,A.jsx)("td",{children:e.quantity||""}),(0,A.jsx)("td",{children:e.unitPrice||""}),(0,A.jsxs)("td",{children:[(0,A.jsx)(h.A,{size:"sm",color:"info",className:"me-2",onClick:()=>((e,s)=>b({isForm:!0,formIndex:e,formData:s}))(s,e),children:(0,A.jsx)("i",{className:"ri-quill-pen-line"})}),(0,A.jsx)(h.A,{size:"sm",color:"danger",outline:!0,onClick:()=>i({isOpen:!0,data:e._id}),children:(0,A.jsx)("i",{className:"ri-close-circle-line"})})]})]})},e._id))})]}),(0,A.jsxs)(d.A,{className:"mt-4 justify-content-between align-items-center",children:[(0,A.jsx)(o.A,{xs:"auto",children:(0,A.jsx)(h.A,{color:"secondary",disabled:1===r,onClick:()=>x(r-1),children:"\u2190 Previous"})}),(0,A.jsxs)(o.A,{className:"text-center text-muted",children:["Showing ",Math.min((r-1)*c+1,t),"\u2013",Math.min(r*c,t)," of ",t]}),(0,A.jsx)(o.A,{xs:"auto",children:(0,A.jsx)(h.A,{color:"secondary",disabled:r===p,onClick:()=>x(r+1),children:"Next \u2192"})})]})]})});var I=t(46005),T=t.n(I),B=t(58786),_=t(7493);const O=["modal","toggle","centers"],E=(0,b.Ng)(e=>({centers:e.Center.data}))(e=>{let{modal:s,toggle:t,centers:i}=e;(0,l.A)(e,O);const[a,c]=(0,n.useState)([]),d=(0,j.Wx)({enableReinitialize:!0,initialValues:{centers:i.map(e=>e._id)||[]},validationSchema:u.Ik({pageAccess:u.YO().test("notEmpty","Centers is required",e=>!(!e||0===e.length))}),onSubmit:e=>{}});return(0,A.jsx)(n.Fragment,{children:(0,A.jsxs)(r.A,{size:"xl",isOpen:s,toggle:t,centered:!0,title:"Add Medicine",children:[(0,A.jsx)("div",{children:(0,A.jsx)(T(),{cssClass:"csv-reader-input",label:"Select Medicine CSV",onFileLoaded:(e,s)=>c(e),parserOptions:{header:!0,dynamicTyping:!0,skipEmptyLines:!0,transformHeader:e=>e.toLowerCase().replace(/\W/g,"_")},inputId:"ObiWan",inputName:"ObiWan",inputStyle:{color:"red"}})}),(0,A.jsxs)("div",{className:"",children:[(0,A.jsx)("h6",{className:"display-6 fs-4 d-block",children:"Centers"}),(0,A.jsx)("div",{className:"d-flex flex-wrap",children:(i||[]).map(e=>(0,A.jsxs)("div",{className:"d-flex me-5 mb-2 align-items-center",children:[(0,A.jsx)(m.A,{className:"me-2 mt-0",type:"checkbox",name:"centers",value:e._id,onChange:d.handleChange,checked:d.values.centers.includes(e._id)}),(0,A.jsx)(_.A,{className:"form-label fs-9 mb-0",children:e.title})]},e._id))})]}),(0,A.jsxs)("div",{className:"mt-4",children:[(0,A.jsx)("h6",{className:"display-6 fs-5",children:"Preview Medicine"}),(0,A.jsx)(B.Ay,{fixedHeader:!0,columns:[{name:"Name",selector:e=>e.drug_name},{name:"Type",selector:e=>e.type},{name:"Strength",selector:e=>e.strength},{name:"Unit",selector:e=>e.unit},{name:"Instructions",selector:e=>e.instruction},{name:"Composition",selector:e=>e.composition},{name:"Quantity",selector:e=>e.quantity},{name:"Batch Number",selector:e=>e.batch_number},{name:"Expiry Date",selector:e=>e.expiry_date},{name:"Unit Price",selector:e=>e.unit_price}],data:a||[],highlightOnHover:!0})]})]})})}),D=()=>{const e=(0,b.wA)(),s=(0,b.d4)(e=>e.Medicine.data),t=(0,b.d4)(e=>e.Medicine.totalCount),a=(0,b.d4)(e=>e.Medicine.totalPages),[l,r]=(0,n.useState)(!1),[c,d]=(0,n.useState)(!1),[o,m]=(0,n.useState)({isOpen:!1,data:null}),[h,x]=(0,n.useState)(""),[u,j]=(0,n.useState)(1),[g,v]=(0,n.useState)(10),N=()=>r(!l),y=()=>d(!c);return(0,n.useEffect)(()=>{e((0,p.aaT)({page:u,limit:g,search:h}))},[e,u,g,h]),(0,A.jsxs)("div",{className:"container-fluid d-flex flex-column h-100 px-3",children:[(0,A.jsx)("div",{className:"mt-4 mx-4",children:(0,A.jsx)(i.A,{title:"Medicine",pageTitle:"Medicine"})}),(0,A.jsx)(z,{toggleForm:N,toggleCSV:y,setSearchItem:x}),(0,A.jsx)("div",{className:"flex-grow-1 d-flex flex-column overflow-auto",children:(0,A.jsx)(F,{medicines:s,totalCount:t,totalPages:a,searchItem:h,setDeleteMedicine:m,currentPage:u,itemsPerPage:g,onPageChange:e=>{j(e)},onItemsPerPageChange:e=>{v(e),j(1)}})}),(0,A.jsx)(f,{modal:l,toggle:N}),(0,A.jsx)(E,{modal:c,toggle:y}),(0,A.jsx)(P.A,{show:o.isOpen,onDeleteClick:()=>{e((0,p.vFe)(o.data)),m({isOpen:!1,data:null})},onCloseClick:()=>{m({isOpen:!1,data:null})}})]})}}}]);
//# sourceMappingURL=424.6487ac17.chunk.js.map